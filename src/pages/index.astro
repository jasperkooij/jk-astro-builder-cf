---
export const prerender = false;

import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import ContactForm from '../components/ContactForm.astro';
import BuilderContentStatic from '../components/BuilderContentStatic.astro';
import FAQSchema from '../components/FAQSchema.astro';

const apiKey = import.meta.env.PUBLIC_BUILDER_API_KEY;
const title = 'Jasper Kooij - Full Stack Developer';
const description = 'Full-stack developer and technical team leader with over 25 years at the forefront of web innovation.';

// Fetch Builder.io content server-side to avoid CLS
let builderContent = null;
try {
	const url = `https://cdn.builder.io/api/v2/content/page?apiKey=${apiKey}&url=/`;
	const response = await fetch(url);
	if (response.ok) {
		const data = await response.json();
		builderContent = data.results?.[0];
	}
} catch (error) {
	console.error('Error fetching Builder.io content:', error);
}
---

<BaseLayout title={title} description={description}>
	<FAQSchema />
	<Navbar />
	<div class="flex min-h-screen items-center justify-center px-4 py-10">
		<div class="bg-base-100 text-base-content w-full max-w-6xl rounded-xl shadow-lg sm:p-10 md:p-6">
			<main>
				<div id="about">
					<BuilderContentStatic content={builderContent} />
				</div>

				<!-- Contact Form Section -->
				<section class="py-12">
					<div class="container mx-auto px-4" id="contact">
						<ContactForm />
					</div>
				</section>
			</main>
		</div>
	</div>
	<Footer />
</BaseLayout>
